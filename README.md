# Humer

*Enhancing Deep Learning-based Vulnerability Detection by Modeling Human Learning Procedures*

This is a part of the open-source code repository for paper "Enhancing Deep Learning-based Vulnerability Detection by Modeling Human Learning Procedures".
Other codes, datas, and models will be uploaded.


## Getting Started

### Requirements

```
python==3.7.4
pandas==1.2.4
pytorch==1.4.0
cudatoolkit=10.1.243
datasets==1.13.0
transformers==4.12.5
```

### Code Structure

```
Humer/
|--data/                        # dataset files
  |--data_all/
    |--trained_vector.vector    # token embeddings lookup table generated by Gensim
  |--train/
    |--sort_3                   # M, submodels
      |--split_3                # N, divide the train set into three courses
        |--data_0.csv           # easy data
        |--data_1.csv           # medium data
        |--data_2.csv           # hard data
      |--split_5
      |--split_10
    |--data_test.csv            # same test data ensures consistent results
  |--AST_data/                  # AST format train set, ASTGRU model requires
    |-- ...
|--model/
  |--BasicModule.py              # model template
  |--TextCNN.py                  # TokenCNN model class
  |--BiGRU.py                    # ASTGRU model class
  |-- ...
|--sort_3_without_wrongdataset   # log and results
|--sort_3_with_wrongdataset      # log and results
|--config.py                     # configuration files such as hyper-parameters
|--main_cl.py                    # run!!!
|--README.md
```



## Usage

### Curriculum Learning without Data Augment

```bash
nohup python -u main_cl.py --output_dir ./sort_3_without_wrongdataset/ --lr=0.0001 --course_learning_epoch 5-5-20 --batch_size=32 --gpu=0 --mode no_wrong_dataset --split_num 3 --label_num=2 --train_dir sort_3/split_3/ --test_dir ./data/train/sort_3/data_test > ./sort_3_without_wrongdataset/sort_3/split_3/TextCNN_sort_3_split_3_without_wrongdataset.log 2>&1 &
```

### Curriculum Learning with Data Augment

```bash
nohup python -u main_cl.py --output_dir ./sort_3_with_wrongdataset/ --lr=0.0001 --course_learning_epoch 5-5-20 --batch_size=32 --gpu=0 --mode wrong_dataset --split_num 3 --label_num=2 --train_dir sort_3/split_3/ --test_dir ./data/train/sort_3/data_test > ./sort_3_with_wrongdataset/sort_3/split_3/TextCNN_sort_3_split_3_with_wrongdataset.log 2>&1 &
```
